import { readFile } from "node:fs/promises";
import { join } from "node:path";
import { ImageResponse } from "next/og";

export async function GET(request: Request) {
  const { searchParams } = new URL(request.url);
  const title = searchParams.get("title");

  const robotoCondensedMedium = await readFile(
    join(process.cwd(), "assets/fonts/RobotoCondensed-Medium.ttf")
  );

  return new ImageResponse(
    (
      <div tw="w-full h-full flex items-center justify-center text-white bg-black p-16">
        <div tw="absolute flex inset-y-0 w-px border border-zinc-800 left-16" />
        <div tw="absolute flex inset-y-0 w-px border border-zinc-800 right-16" />
        <div tw="absolute flex inset-x-0 h-px border border-zinc-800 top-16" />
        <div tw="absolute flex inset-x-0 h-px border border-zinc-800 bottom-16" />


        <div tw="absolute flex bottom-16 right-16">
          <svg
            width={200}
            height={72}
            viewBox="0 0 735 263"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            style={{ color: "white" }} 
          >
            <path d="M385.437 20.6V3H398.311V20.6H385.437Z" fill="currentColor"/>
            <path d="M385.437 38.2001V20.6001H398.311V38.2001H385.437Z" fill="currentColor"/>
            <path d="M385.437 55.8V38.2H398.311V55.8H385.437Z" fill="currentColor"/>
            <path d="M385.437 73.4V55.8H398.311V73.4H385.437Z" fill="currentColor"/>
            <path d="M385.437 90.9999V73.3999H398.311V90.9999H385.437Z" fill="currentColor"/>
            <path d="M398.311 20.6V3H411.185V20.6H398.311Z" fill="currentColor"/>
            <path d="M398.311 55.8V38.2H411.185V55.8H398.311Z" fill="currentColor"/>
            <path d="M411.185 20.6V3H424.059V20.6H411.185Z" fill="currentColor"/>
            <path d="M411.185 55.8V38.2H424.059V55.8H411.185Z" fill="currentColor"/>
            <path d="M424.059 20.6V3H436.933V20.6H424.059Z" fill="currentColor"/>
            <path d="M424.059 55.8V38.2H436.933V55.8H424.059Z" fill="currentColor"/>
            <path d="M436.933 38.2001V20.6001H449.807V38.2001H436.933Z" fill="currentColor"/>
            <path d="M296.437 52.8V35.2H309.311V52.8H296.437Z" fill="currentColor"/>
            <path d="M296.437 70.4V52.8H309.311V70.4H296.437Z" fill="currentColor"/>
            <path d="M296.437 87.9999V70.3999H309.311V87.9999H296.437Z" fill="currentColor"/>
            <path d="M309.311 35.2001V17.6001H322.185V35.2001H309.311Z" fill="currentColor"/>
            <path d="M309.311 70.4V52.8H322.185V70.4H309.311Z" fill="currentColor"/>
            <path d="M322.185 17.6V0H335.059V17.6H322.185Z" fill="currentColor"/>
            <path d="M322.185 70.4V52.8H335.059V70.4H322.185Z" fill="currentColor"/>
            <path d="M335.059 35.2001V17.6001H347.933V35.2001H335.059Z" fill="currentColor"/>
            <path d="M335.059 70.4V52.8H347.933V70.4H335.059Z" fill="currentColor"/>
            <path d="M347.933 52.8V35.2H360.807V52.8H347.933Z" fill="currentColor"/>
            <path d="M347.933 70.4V52.8H360.807V70.4H347.933Z" fill="currentColor"/>
            <path d="M347.933 87.9999V70.3999H360.807V87.9999H347.933Z" fill="currentColor"/>
            <path d="M62.932 233L87.764 142.12H110.036L134.868 233H116.564L98.9 164.136L81.236 233H62.932ZM79.7 213.672L84.308 197.8H113.492L118.1 213.672H79.7ZM140.834 233V164.392H155.042L155.554 180.136L154.146 179.752C155.17 174.12 156.877 169.896 159.266 167.08C161.741 164.264 164.813 162.856 168.482 162.856C172.749 162.856 175.821 164.307 177.698 167.208C179.661 170.024 180.983 174.376 181.666 180.264H179.746C180.685 174.547 182.562 170.237 185.378 167.336C188.194 164.349 191.65 162.856 195.746 162.856C200.781 162.856 204.493 164.691 206.882 168.36C209.271 171.944 210.466 177.619 210.466 185.384V233H194.21V188.84C194.21 184.403 193.783 181.416 192.93 179.88C192.162 178.344 190.925 177.576 189.218 177.576C188.023 177.576 186.957 177.96 186.018 178.728C185.165 179.496 184.482 180.733 183.97 182.44C183.458 184.061 183.202 186.237 183.202 188.968V233H168.098V188.84C168.098 184.573 167.714 181.629 166.946 180.008C166.178 178.387 164.898 177.576 163.106 177.576C161.911 177.576 160.845 177.96 159.906 178.728C158.967 179.496 158.242 180.733 157.73 182.44C157.303 184.061 157.09 186.237 157.09 188.968V233H140.834ZM248.176 233V164.392H265.584V233H248.176ZM222.704 233V219.176H287.216V233H222.704ZM223.984 178.216V164.392H262.384V178.216H223.984ZM247.664 155.944V140.84H265.328V155.944H247.664ZM338.494 233C330.814 233 325.139 231.251 321.47 227.752C317.886 224.253 316.094 218.835 316.094 211.496V148.264H333.502V209.832C333.502 212.989 334.227 215.336 335.678 216.872C337.214 218.408 339.561 219.176 342.718 219.176H358.846V233H338.494ZM296.382 178.216V164.392H358.846V178.216H296.382ZM454.234 233V142.12H483.546C489.861 142.12 495.407 143.357 500.186 145.832C504.965 148.221 508.677 151.635 511.322 156.072C514.053 160.424 515.418 165.501 515.418 171.304C515.418 177.192 514.053 182.312 511.322 186.664C508.677 191.016 504.965 194.429 500.186 196.904C495.407 199.293 489.861 200.488 483.546 200.488H472.41V233H454.234ZM472.41 183.976H481.626C486.746 183.976 490.543 182.909 493.018 180.776C495.493 178.643 496.73 175.485 496.73 171.304C496.73 167.123 495.493 163.965 493.018 161.832C490.543 159.613 486.746 158.504 481.626 158.504H472.41V183.976ZM549.672 234.536C545.491 234.536 541.651 233.768 538.152 232.232C534.653 230.696 531.88 228.477 529.832 225.576C527.869 222.675 526.888 219.219 526.888 215.208C526.888 209.405 528.723 204.883 532.392 201.64C536.147 198.397 541.267 196.093 547.752 194.728L568.36 190.248C568.36 185.896 567.464 182.568 565.672 180.264C563.965 177.96 561.149 176.808 557.224 176.808C553.811 176.808 551.165 177.661 549.288 179.368C547.411 181.075 546.173 183.336 545.576 186.152L527.656 185.128C528.936 178.387 532.136 173.011 537.256 169C542.461 164.904 549.032 162.856 556.968 162.856C566.867 162.856 574.12 165.373 578.728 170.408C583.421 175.357 585.768 182.312 585.768 191.272V215.464C585.768 217.171 586.067 218.365 586.664 219.048C587.261 219.645 588.157 219.944 589.352 219.944H592.168V233C591.656 233.085 590.803 233.171 589.608 233.256C588.413 233.427 587.176 233.512 585.896 233.512C582.483 233.512 579.581 232.915 577.192 231.72C574.803 230.525 572.968 228.776 571.688 226.472C570.493 224.168 569.811 221.395 569.64 218.152H571.56C571.133 221.224 569.981 224.04 568.104 226.6C566.227 229.075 563.709 231.037 560.552 232.488C557.395 233.853 553.768 234.536 549.672 234.536ZM553.256 221.48C556.499 221.48 559.229 220.925 561.448 219.816C563.667 218.621 565.373 216.915 566.568 214.696C567.763 212.392 568.36 209.704 568.36 206.632V202.536L553.128 205.864C550.056 206.547 547.88 207.528 546.6 208.808C545.32 210.088 544.68 211.923 544.68 214.312C544.68 216.531 545.405 218.28 546.856 219.56C548.307 220.84 550.44 221.48 553.256 221.48ZM629.238 233V163.88C629.238 161.235 628.555 159.272 627.19 157.992C625.825 156.627 623.862 155.944 621.302 155.944H606.454V142.12H624.374C631.798 142.12 637.345 143.997 641.014 147.752C644.769 151.421 646.646 156.925 646.646 164.264V233H629.238ZM603.894 233V219.176H668.406V233H603.894Z" fill="currentColor"/>
          </svg>
        </div>

        <h1
          tw="text-center font-medium"
          style={{ fontFamily: "RobotoCondensed", fontSize: 64 }}
        >
          {title}
        </h1>
      </div>
    ),
    {
      width: 1200,
      height: 630,
      fonts: [{ name: "RobotoCondensed", data: robotoCondensedMedium, weight: 500 }],
    }
  );
}
